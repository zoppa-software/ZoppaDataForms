# ZoppaDataForms
データファイルを操作するためのコレクションです。

## 説明
テキストファイルは保存するときに様々な書式ルールによってデータを表現することができます。  
メジャーである `JSON`、`XML` など仕様がはっきりしており、公式のライブラリが存在していますが、古いデータ形式のファイルは仕様が曖昧で、その都度微調整して利用しています。  
このライブラリは私の方言として定義し、業務で使用することを目標としています。  
現在は、以下のファイル形式に対応しています。  
* CSVファイル  
* INIファイル  

## 比較、または特徴
説明でもありますが、仕様が曖昧なデータ形式の実装例として、参考にしていただきたいと思います。  
業務で使用しているとエスケープについても個々のプロジェクトでも個性があるため、エスケープ解除後の文字列、エスケープ解除前の文字列を `UnEscape`プロパティ、`Text`プロパティで取得できるようにしています。  

## 依存関係  
ライブラリは .NET Standard 2.0 で記述しています。そのため、.net framework 4.6.1以降、.net core 2.0以降で使用できます。  
その他のライブラリへの依存関係はありません。  

## 使用方法
### **CSVファイル**
#### 実装仕様
CSVファイルの読み込みは `"` の扱いについて、シンプルに `"` を検出したらエスケープを開始する仕様（`CsvStreamReader`）と EXCELに合わせた仕様（`ExcelCsvStreamReader`）の二種類を用意しています。  
EXCELのCSVファイルの読み込みルールについて明確にはわからなかったため、私の理解した範囲で適用しています。  
#### 使い方

### **INIファイル**
#### 実装仕様
INIファイルの基本的な仕様には従っていますが、一部の振る舞いが他の実装と異なると思っています。  
* コメントは `;` 以降の文字列となります。セクションの定義に `;` は使えません、値内で `;` を使用する場合は `\` でエスケープするか、`"`、`'` で囲むようにしてください
* 値の前端、後端を `"`、`'` で囲むことで、その中で特殊文字（`=`など）をエスケープせずに使用できます。ただし、 `"`で囲まれた範囲内で`"`を使用する場合は`\`でエスケープするか二つ続けて記述します。または`'`で前後を囲むようにしてください（`'`も同じです）  
#### 使い方


## インストール
ソースをビルドして `ZoppaDataForms.dll` ファイルを生成して参照してください。  

## 作成情報
* 造田　崇（zoppa software）
* ミウラ第3システムカンパニー 
* takashi.zouta@kkmiuta.jp

## ライセンス
[apache 2.0](https://www.apache.org/licenses/LICENSE-2.0.html)